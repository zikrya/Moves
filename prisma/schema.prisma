datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id               String  @id @default(cuid())
  email            String  @unique
  stripeCustomerId String? @unique

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  password Password?
  events   Event[]
  tickets  Ticket[]
}

model Password {
  hash String

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  userId String @unique
}

model Event {
  id          String  @id @default(cuid())
  title       String
  description String
  location    String?
  date        String?
  imageURL    String?
  numOfTics   Int?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  userId    String

  user    User     @relation(fields: [userId], references: [id])
  tickets Ticket[]
  prices  Price[]
}

model Price {
  id    String @id @default(cuid())
  name  String
  price Float

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  event   Event    @relation(fields: [eventId], references: [id])
  eventId String
  tickets Ticket[]
}

model Ticket {
  id              String @id @default(cuid())
  stripePaymentId String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  event   Event  @relation(fields: [eventId], references: [id])
  eventId String
  price   Price  @relation(fields: [priceId], references: [id])
  priceId String
  user    User   @relation(fields: [userId], references: [id])
  userId  String
}
